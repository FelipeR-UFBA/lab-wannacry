name: Lab WannaCry
settings:
  sflow_enabled: true
  sflow_collector: 127.0.0.1:6343
  sflow_sampling: 64
  sflow_polling: 10

hosts:

  # Controlador SDN (Kytos)
  c1:
    kind: k8spod
    image: hackinsdn/kytos:allinone
    args:
      - "-E"
    env:
      - {name: "MONGO_USERNAME", value: "kytos"}
      - {name: "MONGO_PASSWORD", value: "kytos"}
      - {name: "MONGO_DBNAME", value: "kytos"}
      - {name: "MONGO_HOST_SEEDS", value: "127.0.0.1:27017"}
    publish:
      - "6653:6653"
      - "8181:8181"
    posX: 443.8
    posY: 123.5
    group: HackInSDN.com

  # Atacante
  atacante:
    ip: 192.168.1.100/24
    kind: k8spod
    image: dockurr/windows
    isolateControlNet: false

    publish:
      - "5901:5900"
      - "8006:5900"     

    env:
      - {name: "VERSION", value: "7u"}
      - {name: "KVM", value: "N"}
      - {name: "VNC", value: "true"}
      - {name: "WEB_VNC", value: "true"}

    postStart:
      - 'sh -c "mkdir -p /data && curl -fsSL --retry 3 --connect-timeout 10 -o /data/Ransomware.WannaCry.zip https://raw.githubusercontent.com/ytisf/theZoo/master/malware/Binaries/Ransomware.WannaCry/Ransomware.WannaCry.zip || true"'

    posX: 110.4
    posY: 249.0
    group: Atacante

  # Vítima 1
  vitima1:
    ip: 192.168.1.101/24
    kind: k8spod
    image: dockurr/windows

    publish:
      - "5902:5900"
      - "8007:5900"     

    env:
      - {name: "VERSION", value: "7u"}
      - {name: "KVM", value: "N"}
      - {name: "VNC", value: "true"}
      - {name: "WEB_VNC", value: "true"}

    posX: 318.1
    posY: 382.0
    group: Vitimas

  # Vítima 2
  vitima2:
    ip: 192.168.1.102/24
    kind: k8spod
    image: dockurr/windows

    publish:
      - "5903:5900"
      - "8008:5900"     

    env:
      - {name: "VERSION", value: "7u"}
      - {name: "KVM", value: "N"}
      - {name: "VNC", value: "true"}
      - {name: "WEB_VNC", value: "true"}

    posX: 442.4
    posY: 382.0
    group: Vitimas

  # Vítima 3
  vitima3:
    ip: 192.168.1.103/24
    kind: k8spod
    image: dockurr/windows

    publish:
      - "5904:5900"
      - "8009:5900"     

    env:
      - {name: "VERSION", value: "7u"}
      - {name: "KVM", value: "N"}
      - {name: "VNC", value: "true"}
      - {name: "WEB_VNC", value: "true"}

    posX: 566.0
    posY: 382.0
    group: Vitimas

switches:
  s1:
    kind: ovs
    group: HackInSDN.com
    posX: 380.0
    posY: 248.4

links:
  - node1: c1
    node2: s1
  - node1: atacante
    node2: s1
  - node1: vitima1
    node2: s1
  - node1: vitima2
    node2: s1
  - node1: vitima3
    node2: s1
